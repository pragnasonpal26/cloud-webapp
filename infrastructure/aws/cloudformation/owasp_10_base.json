{
   "AWSTemplateFormatVersion": "2010-09-09",
   "Description": "AWS WAF Basic OWASP Example Rule Set",
   "Parameters": {
      "stackPrefix": {
         "Type": "String",
         "Description": "The prefix to use when naming resources in this stack. Normally we would use the stack name, but since this template can be used as a resource in other stacks we want to keep the naming consistent. No symbols allowed.",
         "ConstraintDescription": "Alphanumeric characters only, maximum 10 characters",
         "AllowedPattern": "^[a-zA-z0-9]+$",
         "MaxLength": 10,
         "Default": "generic"
      },
      "stackScope": {
         "Type": "String",
         "Description": "You can deploy this stack at a regional level, for regional WAF targets like Application Load Balancers, or for global targets, such as Amazon CloudFront distributions.",
         "AllowedValues": [
            "Global",
            "Regional"
         ],
         "Default": "Regional"
      },
      "ruleAction": {
         "Type": "String",
         "Description": "The type of action you want to iplement for the rules in this set. Valid options are COUNT or BLOCK.",
         "AllowedValues": [
            "BLOCK",
            "COUNT"
         ],
         "Default": "BLOCK"
      },
      "includesPrefix": {
         "Type": "String",
         "Description": "This is the URI path prefix (starting with '/') that identifies any files in your webroot that are server-side included components, and should not be invoked directly via URL. These can be headers, footers, 3rd party server side libraries or components. You can add additional prefixes later directly in the set.",
         "Default": "/includes"
      },
      "adminUrlPrefix": {
         "Type": "String",
         "Description": "This is the URI path prefix (starting with '/') that identifies your administrative sub-site. You can add additional prefixes later directly in the set.",
         "Default": "/admin"
      },
      "adminRemoteCidr": {
         "Type": "String",
         "Description": "This is the IP address allowed to access your administrative interface. Use CIDR notation. You can add additional ones later directly in the set.",
         "Default": "127.0.0.1/32"
      },
      "maxExpectedURISize": {
         "Type": "Number",
         "Description": "Maximum number of bytes allowed in the URI component of the HTTP request. Generally the maximum possible value is determined by the server operating system (maps to file system paths), the web server software, or other middleware components. Choose a value that accomodates the largest URI segment you use in practice in your web application.",
         "Default": 512
      },
      "maxExpectedQueryStringSize": {
         "Type": "Number",
         "Description": "Maximum number of bytes allowed in the query string component of the HTTP request. Normally the  of query string parameters following the \"?\" in a URL is much larger than the URI , but still bounded by the  of the parameters your web application uses and their values.",
         "Default": 1024
      },
      "maxExpectedBodySize": {
         "Type": "Number",
         "Description": "Maximum number of bytes allowed in the body of the request. If you do not plan to allow large uploads, set it to the largest payload value that makes sense for your web application. Accepting unnecessarily large values can cause performance issues, if large payloads are used as an attack vector against your web application.",
         "Default": 4096
      },
      "maxExpectedCookieSize": {
         "Type": "Number",
         "Description": "Maximum number of bytes allowed in the cookie header. The maximum size should be less than 4096, the size is determined by the amount of information your web application stores in cookies. If you only pass a session token via cookies, set the size to no larger than the serialized size of the session token and cookie metadata.",
         "Default": 4093
      },
      "csrfExpectedHeader": {
         "Type": "String",
         "Description": "The custom HTTP request header, where the CSRF token value is expected to be encountered",
         "Default": "x-csrf-token"
      },
      "csrfExpectedSize": {
         "Type": "Number",
         "Description": "The size in bytes of the CSRF token value. For example if it's a canonically formatted UUIDv4 value the expected size would be 36 bytes/ASCII characters",
         "Default": 36
      }
   },
   "Metadata": {
      "AWS::CloudFormation::Interface": {
         "ParameterGroups": [
            {
               "Label": {
                  "default": "Resource Prefix"
               },
               "Parameters": [
                  "stackPrefix"
               ]
            },
            {
               "Label": {
                  "default": "WAF Implementation"
               },
               "Parameters": [
                  "stackScope",
                  "ruleAction"
               ]
            },
            {
               "Label": {
                  "default": "Generic HTTP Request Enforcement"
               },
               "Parameters": [
                  "maxExpectedURISize",
                  "maxExpectedQueryStringSize",
                  "maxExpectedBodySize",
                  "maxExpectedCookieSize"
               ]
            },
            {
               "Label": {
                  "default": "Administrative Interface"
               },
               "Parameters": [
                  "adminUrlPrefix",
                  "adminRemoteCidr"
               ]
            },
            {
               "Label": {
                  "default": "Cross-Site Request Forgery (CSRF)"
               },
               "Parameters": [
                  "csrfExpectedHeader",
                  "csrfExpectedSize"
               ]
            },
            {
               "Label": {
                  "default": "Application Specific"
               },
               "Parameters": [
                  "includesPrefix"
               ]
            }
         ],
         "ParameterLabels": {
            "stackPrefix": {
               "default": "Resource Name Prefix"
            },
            "stackScope": {
               "default": "Apply to WAF"
            },
            "ruleAction": {
               "default": "Rule Effect"
            },
            "includesPrefix": {
               "default": "Server-side components URI prefix"
            },
            "adminUrlPrefix": {
               "default": "URI prefix"
            },
            "adminRemoteCidr": {
               "default": "Allowed IP source (CIDR)"
            },
            "maxExpectedURISize": {
               "default": "Max. size of URI"
            },
            "maxExpectedQueryStringSize": {
               "default": "Max. size of QUERY STRING"
            },
            "maxExpectedBodySize": {
               "default": "Max. size of BODY"
            },
            "maxExpectedCookieSize": {
               "default": "Max. size of COOKIE"
            },
            "csrfExpectedHeader": {
               "default": "HTTP Request Header"
            },
            "csrfExpectedSize": {
               "default": "Token Size"
            }
         }
      }
   },
   "Conditions": {
      "isRegional": null,
      "isGlobal": null
   },
   "Resources": {
      "wafrSQLiSet": {
         "Type": "AWS::WAFRegional::SqlInjectionMatchSet",
         "Condition": "isRegional",
         "Properties": {
            "Name": "wafrSQLiSet",
            "SqlInjectionMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "BODY"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "BODY"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "cookie"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "cookie"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               }
            ]
         }
      },
      "wafgSQLiSet": {
         "Type": "AWS::WAF::SqlInjectionMatchSet",
         "Condition": "isGlobal",
         "Properties": {
            "Name": "wafgSQLiSet",
            "SqlInjectionMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "BODY"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "BODY"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "cookie"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "cookie"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               }
            ]
         }
      },
      "wafrSQLiRule": {
         "Type": "AWS::WAFRegional::Rule",
         "Condition": "isRegional",
         "Properties": {
            "Predicates": [
               {
                  "Type": "SqlInjectionMatch",
                  "Negated": false
               }
            ]
         }
      },
      "wafgSQLiRule": {
         "Type": "AWS::WAF::Rule",
         "Condition": "isGlobal",
         "Properties": {
            "Predicates": [
               {
                  "Type": "SqlInjectionMatch",
                  "Negated": false
               }
            ]
         }
      },
      "wafrAuthTokenStringSet": {
         "Type": "AWS::WAFRegional::ByteMatchSet",
         "Condition": "isRegional",
         "Properties": {
            "Name": "wafrAuthTokenStringSet",
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "cookie"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "example-session-id",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "authorization"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ",
                  "TextTransformation": "URL_DECODE"
               }
            ]
         }
      },
      "wafgAuthTokenStringSet": {
         "Type": "AWS::WAF::ByteMatchSet",
         "Condition": "isGlobal",
         "Properties": {
            "Name": "wafgAuthTokenStringSet",
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "cookie"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "example-session-id",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "authorization"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ",
                  "TextTransformation": "URL_DECODE"
               }
            ]
         }
      },
      "wafrAuthTokenRule": {
         "Type": "AWS::WAFRegional::Rule",
         "Condition": "isRegional",
         "Properties": {
            "Predicates": [
               {
                  "Type": "ByteMatch",
                  "Negated": false
               }
            ]
         }
      },
      "wafgAuthTokenRule": {
         "Type": "AWS::WAF::Rule",
         "Condition": "isGlobal",
         "Properties": {
            "Predicates": [
               {
                  "Type": "ByteMatch",
                  "Negated": false
               }
            ]
         }
      },
      "wafrXSSSet": {
         "Type": "AWS::WAFRegional::XssMatchSet",
         "Condition": "isRegional",
         "Properties": {
            "XssMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "BODY"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "BODY"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "cookie"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "cookie"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               }
            ]
         }
      },
      "wafgXSSSet": {
         "Type": "AWS::WAF::XssMatchSet",
         "Condition": "isGlobal",
         "Properties": {
            "XssMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "BODY"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "BODY"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "cookie"
                  },
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "cookie"
                  },
                  "TextTransformation": "HTML_ENTITY_DECODE"
               }
            ]
         }
      },
      "wafrXSSRule": {
         "Type": "AWS::WAFRegional::Rule",
         "Condition": "isRegional",
         "Properties": {
            "Predicates": [
               {
                  "Type": "XssMatch",
                  "Negated": false
               }
            ]
         }
      },
      "wafgXSSRule": {
         "Type": "AWS::WAF::Rule",
         "Condition": "isGlobal",
         "Properties": {
            "Predicates": [
               {
                  "Type": "XssMatch",
                  "Negated": false
               }
            ]
         }
      },
      "wafrPathsStringSet": {
         "Type": "AWS::WAFRegional::ByteMatchSet",
         "Condition": "isRegional",
         "Properties": {
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "../",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "../",
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "../",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "../",
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "://",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "://",
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "://",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "://",
                  "TextTransformation": "HTML_ENTITY_DECODE"
               }
            ]
         }
      },
      "wafgPathsStringSet": {
         "Type": "AWS::WAF::ByteMatchSet",
         "Condition": "isGlobal",
         "Properties": {
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "../",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "../",
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "../",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "../",
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "://",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "://",
                  "TextTransformation": "HTML_ENTITY_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "://",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "://",
                  "TextTransformation": "HTML_ENTITY_DECODE"
               }
            ]
         }
      },
      "wafrPathsRule": {
         "Type": "AWS::WAFRegional::Rule",
         "Condition": "isRegional",
         "Properties": {
            "Predicates": [
               {
                  "Type": "ByteMatch",
                  "Negated": false
               }
            ]
         }
      },
      "wafgPathsRule": {
         "Type": "AWS::WAF::Rule",
         "Condition": "isGlobal",
         "Properties": {
            "Predicates": [
               {
                  "Type": "ByteMatch",
                  "Negated": false
               }
            ]
         }
      },
      "wafrAdminUrlStringSet": {
         "Type": "AWS::WAFRegional::ByteMatchSet",
         "Condition": "isRegional",
         "Properties": {
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "STARTS_WITH",
                  "TextTransformation": "URL_DECODE"
               }
            ]
         }
      },
      "wafgAdminUrlStringSet": {
         "Type": "AWS::WAF::ByteMatchSet",
         "Condition": "isGlobal",
         "Properties": {
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "STARTS_WITH",
                  "TextTransformation": "URL_DECODE"
               }
            ]
         }
      },
      "wafrAdminRemoteAddrIpSet": {
         "Type": "AWS::WAFRegional::IPSet",
         "Condition": "isRegional",
         "Properties": {
            "IPSetDescriptors": [
               {
                  "Type": "IPV4"
               }
            ]
         }
      },
      "wafgAdminRemoteAddrIpSet": {
         "Type": "AWS::WAF::IPSet",
         "Condition": "isGlobal",
         "Properties": {
            "IPSetDescriptors": [
               {
                  "Type": "IPV4"
               }
            ]
         }
      },
      "wafrAdminAccessRule": {
         "Type": "AWS::WAFRegional::Rule",
         "Condition": "isRegional",
         "Properties": {
            "Predicates": [
               {
                  "Type": "ByteMatch",
                  "Negated": false
               },
               {
                  "Type": "IPMatch",
                  "Negated": true
               }
            ]
         }
      },
      "wafgAdminAccessRule": {
         "Type": "AWS::WAF::Rule",
         "Condition": "isGlobal",
         "Properties": {
            "Predicates": [
               {
                  "Type": "ByteMatch",
                  "Negated": false,
                  "DataId": null
               },
               {
                  "Type": "IPMatch",
                  "Negated": true,
                  "DataId": null
               }
            ]
         }
      },
      "wafrPHPInsecureQSStringSet": {
         "Type": "AWS::WAFRegional::ByteMatchSet",
         "Condition": "isRegional",
         "Properties": {
            "Name": null,
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "_SERVER[",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "_ENV[",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "auto_prepend_file=",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "auto_append_file=",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "allow_url_include=",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "disable_functions=",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "open_basedir=",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "safe_mode=",
                  "TextTransformation": "URL_DECODE"
               }
            ]
         }
      },
      "wafgPHPInsecureQSStringSet": {
         "Type": "AWS::WAF::ByteMatchSet",
         "Condition": "isGlobal",
         "Properties": {
            "Name": null,
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "_SERVER[",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "_ENV[",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "auto_prepend_file=",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "auto_append_file=",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "allow_url_include=",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "disable_functions=",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "open_basedir=",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "PositionalConstraint": "CONTAINS",
                  "TargetString": "safe_mode=",
                  "TextTransformation": "URL_DECODE"
               }
            ]
         }
      },
      "wafrPHPInsecureURIStringSet": {
         "Type": "AWS::WAFRegional::ByteMatchSet",
         "Condition": "isRegional",
         "Properties": {
            "Name": null,
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": "php",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": "/",
                  "TextTransformation": "URL_DECODE"
               }
            ]
         }
      },
      "wafgPHPInsecureURIStringSet": {
         "Type": "AWS::WAF::ByteMatchSet",
         "Condition": "isGlobal",
         "Properties": {
            "Name": null,
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": "php",
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": "/",
                  "TextTransformation": "URL_DECODE"
               }
            ]
         }
      },
      "wafrPHPInsecureRule": {
         "Type": "AWS::WAFRegional::Rule",
         "Condition": "isRegional",
         "Properties": {
            "MetricName": null,
            "Name": null,
            "Predicates": [
               {
                  "Type": "ByteMatch",
                  "Negated": false,
                  "DataId": null
               },
               {
                  "Type": "ByteMatch",
                  "Negated": false,
                  "DataId": null
               }
            ]
         }
      },
      "wafgPHPInsecureRule": {
         "Type": "AWS::WAF::Rule",
         "Condition": "isGlobal",
         "Properties": {
            "MetricName": null,
            "Name": null,
            "Predicates": [
               {
                  "Type": "ByteMatch",
                  "Negated": false,
                  "DataId": null
               },
               {
                  "Type": "ByteMatch",
                  "Negated": false,
                  "DataId": null
               }
            ]
         }
      },
      "wafrSizeRestrictionSet": {
         "Type": "AWS::WAFRegional::SizeConstraintSet",
         "Condition": "isRegional",
         "Properties": {
            "Name": null,
            "SizeConstraints": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "TextTransformation": "NONE",
                  "ComparisonOperator": "GT",
                  "Size": null
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "TextTransformation": "NONE",
                  "ComparisonOperator": "GT",
                  "Size": null
               },
               {
                  "FieldToMatch": {
                     "Type": "BODY"
                  },
                  "TextTransformation": "NONE",
                  "ComparisonOperator": "GT",
                  "Size": null
               },
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "cookie"
                  },
                  "TextTransformation": "NONE",
                  "ComparisonOperator": "GT",
                  "Size": null
               }
            ]
         }
      },
      "wafgSizeRestrictionSet": {
         "Type": "AWS::WAF::SizeConstraintSet",
         "Condition": "isGlobal",
         "Properties": {
            "Name": null,
            "SizeConstraints": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "TextTransformation": "NONE",
                  "ComparisonOperator": "GT",
                  "Size": null
               },
               {
                  "FieldToMatch": {
                     "Type": "QUERY_STRING"
                  },
                  "TextTransformation": "NONE",
                  "ComparisonOperator": "GT",
                  "Size": null
               },
               {
                  "FieldToMatch": {
                     "Type": "BODY"
                  },
                  "TextTransformation": "NONE",
                  "ComparisonOperator": "GT",
                  "Size": null
               },
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": "cookie"
                  },
                  "TextTransformation": "NONE",
                  "ComparisonOperator": "GT",
                  "Size": null
               }
            ]
         }
      },
      "wafrSizeRestrictionRule": {
         "Type": "AWS::WAFRegional::Rule",
         "Condition": "isRegional",
         "Properties": {
            "MetricName": null,
            "Name": null,
            "Predicates": [
               {
                  "Type": "SizeConstraint",
                  "Negated": false,
                  "DataId": null
               }
            ]
         }
      },
      "wafgSizeRestrictionRule": {
         "Type": "AWS::WAF::Rule",
         "Condition": "isGlobal",
         "Properties": {
            "MetricName": null,
            "Name": null,
            "Predicates": [
               {
                  "Type": "SizeConstraint",
                  "Negated": false,
                  "DataId": null
               }
            ]
         }
      },
      "wafrCSRFMethodStringSet": {
         "Type": "AWS::WAFRegional::ByteMatchSet",
         "Condition": "isRegional",
         "Properties": {
            "Name": null,
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "METHOD"
                  },
                  "PositionalConstraint": "EXACTLY",
                  "TargetString": "post",
                  "TextTransformation": "LOWERCASE"
               }
            ]
         }
      },
      "wafgCSRFMethodStringSet": {
         "Type": "AWS::WAF::ByteMatchSet",
         "Condition": "isGlobal",
         "Properties": {
            "Name": null,
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "METHOD"
                  },
                  "PositionalConstraint": "EXACTLY",
                  "TargetString": "post",
                  "TextTransformation": "LOWERCASE"
               }
            ]
         }
      },
      "wafrCSRFTokenSizeConstraint": {
         "Type": "AWS::WAFRegional::SizeConstraintSet",
         "Condition": "isRegional",
         "Properties": {
            "Name": null,
            "SizeConstraints": [
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": null
                  },
                  "TextTransformation": "NONE",
                  "ComparisonOperator": "EQ",
                  "Size": null
               }
            ]
         }
      },
      "wafgCSRFTokenSizeConstraint": {
         "Type": "AWS::WAF::SizeConstraintSet",
         "Condition": "isGlobal",
         "Properties": {
            "Name": null,
            "SizeConstraints": [
               {
                  "FieldToMatch": {
                     "Type": "HEADER",
                     "Data": null
                  },
                  "TextTransformation": "NONE",
                  "ComparisonOperator": "EQ",
                  "Size": null
               }
            ]
         }
      },
      "wafrCSRFRule": {
         "Type": "AWS::WAFRegional::Rule",
         "Condition": "isRegional",
         "Properties": {
            "MetricName": null,
            "Name": null,
            "Predicates": [
               {
                  "Type": "ByteMatch",
                  "Negated": false,
                  "DataId": null
               },
               {
                  "Type": "SizeConstraint",
                  "Negated": true,
                  "DataId": null
               }
            ]
         }
      },
      "wafgCSRFRule": {
         "Type": "AWS::WAF::Rule",
         "Condition": "isGlobal",
         "Properties": {
            "MetricName": null,
            "Name": null,
            "Predicates": [
               {
                  "Type": "ByteMatch",
                  "Negated": false,
                  "DataId": null
               },
               {
                  "Type": "SizeConstraint",
                  "Negated": true,
                  "DataId": null
               }
            ]
         }
      },
      "wafrServerSideIncludeStringSet": {
         "Type": "AWS::WAFRegional::ByteMatchSet",
         "Condition": "isRegional",
         "Properties": {
            "Name": null,
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "STARTS_WITH",
                  "TargetString": null,
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".cfg",
                  "TextTransformation": "LOWERCASE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".conf",
                  "TextTransformation": "LOWERCASE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".config",
                  "TextTransformation": "LOWERCASE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".ini",
                  "TextTransformation": "LOWERCASE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".log",
                  "TextTransformation": "LOWERCASE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".bak",
                  "TextTransformation": "LOWERCASE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".backup",
                  "TextTransformation": "LOWERCASE"
               }
            ]
         }
      },
      "wafgServerSideIncludeStringSet": {
         "Type": "AWS::WAF::ByteMatchSet",
         "Condition": "isGlobal",
         "Properties": {
            "Name": null,
            "ByteMatchTuples": [
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "STARTS_WITH",
                  "TargetString": null,
                  "TextTransformation": "URL_DECODE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".cfg",
                  "TextTransformation": "LOWERCASE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".conf",
                  "TextTransformation": "LOWERCASE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".config",
                  "TextTransformation": "LOWERCASE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".ini",
                  "TextTransformation": "LOWERCASE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".log",
                  "TextTransformation": "LOWERCASE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".bak",
                  "TextTransformation": "LOWERCASE"
               },
               {
                  "FieldToMatch": {
                     "Type": "URI"
                  },
                  "PositionalConstraint": "ENDS_WITH",
                  "TargetString": ".backup",
                  "TextTransformation": "LOWERCASE"
               }
            ]
         }
      },
      "wafrServerSideIncludeRule": {
         "Type": "AWS::WAFRegional::Rule",
         "Condition": "isRegional",
         "Properties": {
            "MetricName": null,
            "Name": null,
            "Predicates": [
               {
                  "Type": "ByteMatch",
                  "Negated": false,
                  "DataId": null
               }
            ]
         }
      },
      "wafgServerSideIncludeRule": {
         "Type": "AWS::WAF::Rule",
         "Condition": "isGlobal",
         "Properties": {
            "MetricName": null,
            "Name": null,
            "Predicates": [
               {
                  "Type": "ByteMatch",
                  "Negated": false,
                  "DataId": null
               }
            ]
         }
      },
      "wafrBlacklistIpSet": {
         "Type": "AWS::WAFRegional::IPSet",
         "Condition": "isRegional",
         "Properties": {
            "Name": null,
            "IPSetDescriptors": [
               {
                  "Type": "IPV4",
                  "Value": "10.0.0.0/8"
               },
               {
                  "Type": "IPV4",
                  "Value": "192.168.0.0/16"
               },
               {
                  "Type": "IPV4",
                  "Value": "169.254.0.0/16"
               },
               {
                  "Type": "IPV4",
                  "Value": "172.16.0.0/16"
               },
               {
                  "Type": "IPV4",
                  "Value": "127.0.0.1/32"
               }
            ]
         }
      },
      "wafgBlacklistIpSet": {
         "Type": "AWS::WAF::IPSet",
         "Condition": "isGlobal",
         "Properties": {
            "Name": null,
            "IPSetDescriptors": [
               {
                  "Type": "IPV4",
                  "Value": "10.0.0.0/8"
               },
               {
                  "Type": "IPV4",
                  "Value": "192.168.0.0/16"
               },
               {
                  "Type": "IPV4",
                  "Value": "169.254.0.0/16"
               },
               {
                  "Type": "IPV4",
                  "Value": "172.16.0.0/16"
               },
               {
                  "Type": "IPV4",
                  "Value": "127.0.0.1/32"
               }
            ]
         }
      },
      "wafrBlacklistIpRule": {
         "Type": "AWS::WAFRegional::Rule",
         "Condition": "isRegional",
         "Properties": {
            "MetricName": null,
            "Name": null,
            "Predicates": [
               {
                  "Type": "IPMatch",
                  "Negated": false,
                  "DataId": null
               }
            ]
         }
      },
      "wafgBlacklistIpRule": {
         "Type": "AWS::WAF::Rule",
         "Condition": "isGlobal",
         "Properties": {
            "MetricName": null,
            "Name": null,
            "Predicates": [
               {
                  "Type": "IPMatch",
                  "Negated": false,
                  "DataId": null
               }
            ]
         }
      },
      "wafrOwaspACL": {
         "Type": "AWS::WAFRegional::WebACL",
         "Condition": "isRegional",
         "Properties": {
            "DefaultAction": {
               "Type": "ALLOW"
            },
            "Rules": [
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 10,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 20,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 30,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 40,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 50,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 60,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 70,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 80,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 90,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 100,
                  "RuleId": null
               }
            ]
         }
      },
      "wafgOwaspACL": {
         "Type": "AWS::WAF::WebACL",
         "Condition": "isGlobal",
         "Properties": {
            "DefaultAction": {
               "Type": "ALLOW"
            },
            "Rules": [
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 10,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 20,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 30,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 40,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 50,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 60,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 70,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 80,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 90,
                  "RuleId": null
               },
               {
                  "Action": {
                     "Type": null
                  },
                  "Priority": 100,
                  "RuleId": null
               }
            ]
         }
      }
   }
}